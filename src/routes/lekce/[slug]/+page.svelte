<script>
  export let data;
  import mdParser from "$lib/utils/md-parser";
  import { onMount } from "svelte";
  import SQLite from "tauri-plugin-sqlite-api";

  let rows = [];

  let id = data.slug; // to recognize which lection is opened

  let query = `SELECT * FROM lekce WHERE id = ?`;

  let parsed;

  onMount(async () => {
    const db = await SQLite.open("./hanzi.db");

    rows = await db.select(query, [id]);

    console.log(rows[0].markdown);
    parsed = mdParser(rows[0].markdown);
  });
</script>

<div class="bg-gradient-to-r from-purple-100 to-white flex">
  <div class="pr-5 pl-10 pt-20 basis-2/12">
    <ul class="pl-0">
      <li><a href="/lekce/1">Lekce 1</a></li>
      <li><a href="/lekce/2">Lekce 2</a></li>
      <li><a href="/lekce/3">Lekce 3</a></li>
      <li><a href="/lekce/4">Lekce 4</a></li>
    </ul>
  </div>

  <div class="border-2 border-solid p-5 bg-white mt-20 border-black basis-8/12">
    <h1>{id}</h1>
    <div>{@html parsed}</div>
  </div>

  <div class="pr-5 pl-10 pt-20 basis-2/12" />
</div>
